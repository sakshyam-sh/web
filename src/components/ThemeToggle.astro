---
import { Icon } from 'astro-icon/components';
---

<button id="theme-toggle" aria-label="Toggle theme">
  <Icon name="mdi:white-balance-sunny" class="sun" />
  <Icon name="mdi:moon-waning-crescent" class="moon" />
</button>

<style>
  button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    color: var(--fg);
    opacity: 0.7;
    transition: opacity 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  button:hover { opacity: 1; }

  .sun { display: block; width: 1.5rem; height: 1.5rem; }
  .moon { display: none; width: 1.5rem; height: 1.5rem; }

  /* These selectors look for the .dark class on the <html> tag */
  :global(.dark) .sun { display: none; }
  :global(.dark) .moon { display: block; }
</style>

<script>
  // This function runs in the browser
  const toggleTheme = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  };

  document.getElementById("theme-toggle")?.addEventListener("click", toggleTheme);
</script>
